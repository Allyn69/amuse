Index: athena/src/athena4.0/src/Makefile.in
===================================================================
--- athena.orig/src/athena4.0/src/Makefile.in	2010-06-19 20:52:57.000000000 +0200
+++ athena/src/athena4.0/src/Makefile.in	2010-12-09 11:09:48.000000000 +0100
@@ -106,12 +106,13 @@
 	       rsolvers/two_shock.o
 
 ALL_OBJ = ${CORE_OBJ} ${FFT_OBJ} ${GRAVITY_OBJ} ${INTEGRATORS_OBJ} ${MICROPHYS_OBJ} ${PARTICLES_OBJ} ${RECONSTRUCTION_OBJ} ${RSOLVERS_OBJ}
-
+LIB_OBJ = $(subst main.o,,${ALL_OBJ})
 #-------------------  macro definitions  ---------------------------------------
 
 BIN = ${EXEDIR}athena
 EXEDIR = ../bin/
 SRC = $(ALL_OBJ:.o=.c)
+LIBFILE = $(EXEDIR)libathena.a
 
 include ../Makeoptions
 
@@ -125,11 +126,15 @@
 all:	compile
 
 .PHONY: compile
-compile: ${BIN}
+compile: ${BIN} $(LIBFILE)
 
 ${BIN}: ${ALL_OBJ}
 	${LDR} $(OPT) -o ${EXEDIR}athena ${ALL_OBJ} ${LIB}
 
+$(LIBFILE): $(LIB_OBJ)
+	ar rv $(LIBFILE) $(LIB_OBJ)
+	ranlib $(LIBFILE)
+	
 help:
 	@echo This is the Athena Makefile
 	@echo Type 'make compile' to generate Athena executable
Index: athena/src/athena4.0/Makeoptions.in
===================================================================
--- athena.orig/src/athena4.0/Makeoptions.in	2010-04-04 18:10:21.000000000 +0200
+++ athena/src/athena4.0/Makeoptions.in	2010-12-09 11:11:58.000000000 +0100
@@ -82,7 +82,9 @@
   FFTWLIB = -L/opt/local/lib -lfftw3
   FFTWINC = -I/opt/local/include
 else
-  abort Unsupported MACHINE=$(MACHINE)
+# -- For AMUSE, removed abort
+# -- removed abort as we will get all options
+# -- through the AMUSE makefile
 endif
 endif
 endif
Index: athena/src/athena4.0/src/Makefile
===================================================================
--- athena.orig/src/athena4.0/src/Makefile	2010-12-09 11:08:19.000000000 +0100
+++ athena/src/athena4.0/src/Makefile	2010-12-09 11:12:33.000000000 +0100
@@ -106,12 +106,13 @@
 	       rsolvers/two_shock.o
 
 ALL_OBJ = ${CORE_OBJ} ${FFT_OBJ} ${GRAVITY_OBJ} ${INTEGRATORS_OBJ} ${MICROPHYS_OBJ} ${PARTICLES_OBJ} ${RECONSTRUCTION_OBJ} ${RSOLVERS_OBJ}
-
+LIB_OBJ = $(subst main.o,,${ALL_OBJ})
 #-------------------  macro definitions  ---------------------------------------
 
 BIN = ${EXEDIR}athena
 EXEDIR = ../bin/
 SRC = $(ALL_OBJ:.o=.c)
+LIBFILE = $(EXEDIR)libathena.a
 
 include ../Makeoptions
 
@@ -125,11 +126,15 @@
 all:	compile
 
 .PHONY: compile
-compile: ${BIN}
+compile: ${BIN} $(LIBFILE)
 
 ${BIN}: ${ALL_OBJ}
 	${LDR} $(OPT) -o ${EXEDIR}athena ${ALL_OBJ} ${LIB}
 
+$(LIBFILE): $(LIB_OBJ)
+	ar rv $(LIBFILE) $(LIB_OBJ)
+	ranlib $(LIBFILE)
+	
 help:
 	@echo This is the Athena Makefile
 	@echo Type 'make compile' to generate Athena executable
