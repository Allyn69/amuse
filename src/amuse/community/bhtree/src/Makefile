AMUSE_DIR?=../../../../..
include ${AMUSE_DIR}/config.mk

CODELIB = libbhtree.a

CXXFLAGS += -DTREE -DNOGRAPHICS 

OBJ = BHTC.o nbody.o BHtree.o gravity.o pgetopt.o second.o

CODEOBJS = BHtree.o gravity.o pgetopt.o second.o nbody.o

AR = ar ruv
RANLIB = ranlib
RM = rm

SCLIBS ?= -L$(AMUSE_DIR)/lib/stopcond -lstopcond
SCINC ?= -I$(AMUSE_DIR)/lib/stopcond

all: BHTC $(CODELIB)

clean:
	rm -f *.o BHTC *~ $(CODELIB)

BHTC: $(OBJ)
	$(CXX) $(CXXFLAGS) $(OBJ) -lm -o BHTC $(SCLIBS)

.c.o:
	$(CC) $(CPPFLAGS) $(CFLAGS) $(SCINC) -c $?

.C.o:
	$(CXX) $(CPPFLAGS) $(CXXFLAGS) $(SCINC) -c $?

test: compile

compile: BHTC

$(CODELIB): $(CODEOBJS)
	$(RM) -f $@
	$(AR) $@ $(CODEOBJS)
	$(RANLIB) $@

